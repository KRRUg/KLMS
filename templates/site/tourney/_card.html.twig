{% set registered = registered | default(false) %}
{% set current_game = current_game | default(null) %}
{% set expand = expand | default(false) %}

{% macro game_icon(tourney, game = null) %}
    <i class="fa-solid fa-gamepad fa-2xl
    {% if tourney.isRunning %}
        {% if game is null %} text-muted {% elseif game.isPending() %} text-primary fa-beat-fade{% endif %}
    {% endif %}"></i>
{% endmacro %}

<div class="card mb-3 tourney {% if registered %}registered{% endif %}" id="tourney-{{ tourney.id }}">
    <div class="card-header">
        <h4 class="mb-0">
        <button class="btn btn-block d-flex justify-content-between align-items-center" type="button" data-toggle="collapse" data-target="#collapse-{{ tourney.id }}">
            {{ tourney.name }}
            {% if registered %}{{ _self.game_icon(tourney, current_game) }}{% endif %}
        </button>
        </h4>
    </div>
    <div class="collapse{% if expand %} show{% endif %}" id="collapse-{{ tourney.id }}">
        {% set TourneyStatus = enum('\\App\\Entity\\TourneyStatus') %}
        <div class="card-body">
            {% if tourney.status == TourneyStatus.Created %}
                {% include 'site/tourney/_created.html.twig' %}
            {% elseif tourney.status == TourneyStatus.Registration %}
                {% if participates %}
                    {% if registered %}
                        {% include 'site/tourney/_registered.html.twig' with {tm : tm} %}
                    {% else %}
                        {% include 'site/tourney/_register.html.twig' %}
                    {% endif %}
                {% endif %}
            {% elseif tourney.status == TourneyStatus.Running %}
                {% include 'site/tourney/_running.html.twig' with { current_game : current_game} %}
            {% elseif tourney.status == TourneyStatus.Finished %}
                {% include 'site/tourney/_result.html.twig' %}
            {% endif %}
            <p><b>Status:</b> {{ tourney.status.message }}</p>
{#            {% if tourney.rules is not empty %}#}
{#                <b>Regeln:</b> #}
{#            {% endif %}#}
            <p><b>Modus:</b> {{ tourney.mode == 'de' ? "double elimination" : "single elemination" }}</p>
            {% if tourney.description is not empty %}
                <p><b>Beschreibung:</b> {{ tourney.description | raw }}</p>
            {% endif %}
        </div>
    </div>
</div>