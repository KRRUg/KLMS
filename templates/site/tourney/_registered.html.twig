{% set fur = forms[constant('App\\Controller\\Site\\TourneyController::FORM_NAME_UNREGISTER')] | default(null) %}

{% macro unregister_form(form) %}
    {% if form is not null %}{{ form_start(form, { 'attr': {'class': ''}}) }}<div class="text-right">{{ form_widget(form.submit, { 'attr': {'class': 'btn btn-secondary btn-sm'}}) }}</div>{{ form_end(form) }}{% endif %}
{% endmacro %}

{% macro accept_decline_form(form) %}
    {% if form is not null %}
        {{ form_start(form, { 'attr': {'class': 'form-inline'}}) }}
        {{ form_widget(form.accept, { 'attr': {'class': 'btn btn-link'}}) }}
        {{ form_widget(form.decline, { 'attr': {'class': 'btn btn-link'}}) }}
        {{ form_end(form) }}
    {% endif %}
{% endmacro %}

<div class="box box-body container-fluid">
    {% set team = tm.team %}
    {% if tourney.isSinglePlayer() %}
        Du bist zu diesem Turnier angemeldet. {{ _self.unregister_form(fur) }}
    {% else %}
        {% if not tm.accepted %}
            <i class="fa-solid fa-hourglass"></i>
            <span>Warten auf Best√§tigung von <b>{{ team.name }}</b>.</span>
            {{ _self.unregister_form(fur) }}
        {% else %}
            <h6><b>{{ team.name }}</b> ({{ team.countUsers }}/{{ tourney.teamsize }})</h6>
            <ul class="list-unstyled">
                {% set facs = forms[constant('App\\Controller\\Site\\TourneyController::FORM_NAME_CONFIRM')] | default([]) %}
                {% for member in team.members %}
                    <li>{{ member.gamer | username }}
                    {% if not member.accepted %}
                        ?
                        {{ _self.accept_decline_form(facs[member.id] | default(null)) }}
                    {% endif %}
                    </li>
                {% endfor %}
                {{ _self.unregister_form(fur) }}
            </ul>
        {% endif %}
    {% endif %}
</div>